{
  "version": 3,
  "sources": ["../../../src/client/wasm-loader.ts"],
  "sourcesContent": ["// Copyright (c) dWallet Labs, Ltd.\n// SPDX-License-Identifier: BSD-3-Clause-Clear\n\nimport type * as WasmModule from '@ika.xyz/ika-wasm';\n\nlet wasmModule: typeof WasmModule | null = null;\nlet initPromise: Promise<void> | null = null;\nconst isNode = typeof process !== 'undefined' && !!process.versions?.node;\n\nexport async function ensureWasmInitialized() {\n\tif (wasmModule) return;\n\tif (!initPromise) initPromise = init();\n\tawait initPromise;\n}\n\nasync function init() {\n\t// Always import root; exports pick web vs node for us\n\tconst mod: any = await import('@ika.xyz/ika-wasm');\n\n\tif (isNode) {\n\t\t// Node glue self-initializes (uses fs internally)\n\t\tconst normalized = mod && typeof mod === 'object' && 'default' in mod ? mod.default : mod;\n\t\tif (typeof normalized.generate_secp_cg_keypair_from_seed !== 'function') {\n\t\t\tthrow new Error('ika-wasm node glue not initialized (wrong target?)');\n\t\t}\n\t\twasmModule = normalized as typeof WasmModule;\n\t\treturn;\n\t}\n\n\t// Web glue: explicitly init with NO args so it fetches its own wasm URL\n\tconst initFn: any = mod.default ?? mod.init;\n\tif (typeof initFn !== 'function') throw new Error('ika-wasm web glue missing init()');\n\tawait initFn(); // <\u2014 NO url here\n\twasmModule = mod as typeof WasmModule;\n}\n\nasync function getWasmModule() {\n\tawait ensureWasmInitialized();\n\treturn wasmModule!;\n}\n\n// Export wrapped functions that ensure WASM is initialized\nexport async function encrypt_secret_share(\n\tcurve: number,\n\tuserSecretKeyShare: Uint8Array,\n\tencryptionKey: Uint8Array,\n\tprotocolPublicParameters: Uint8Array,\n): Promise<Uint8Array> {\n\tconst wasm = await getWasmModule();\n\treturn wasm.encrypt_secret_share(\n\t\tcurve,\n\t\tuserSecretKeyShare,\n\t\tencryptionKey,\n\t\tprotocolPublicParameters,\n\t);\n}\n\nexport async function verify_user_share(\n\tcurve: number,\n\tuserSecretKeyShare: Uint8Array,\n\tuserDKGOutput: Uint8Array,\n\tnetworkDkgPublicOutput: Uint8Array,\n): Promise<boolean> {\n\tconst wasm = await getWasmModule();\n\treturn wasm.verify_user_share(curve, userSecretKeyShare, userDKGOutput, networkDkgPublicOutput);\n}\n\nexport async function generate_secp_cg_keypair_from_seed(\n\tcurve: number,\n\tseed: Uint8Array,\n): Promise<[Uint8Array, Uint8Array]> {\n\tconst wasm = await getWasmModule();\n\treturn wasm.generate_secp_cg_keypair_from_seed(curve, seed);\n}\n\nexport async function create_dkg_centralized_output_v1(\n\tprotocolPublicParameters: Uint8Array,\n\tnetworkFirstRoundOutput: Uint8Array,\n): Promise<[Uint8Array, Uint8Array, Uint8Array]> {\n\tconst wasm = await getWasmModule();\n\treturn wasm.create_dkg_centralized_output_v1(protocolPublicParameters, networkFirstRoundOutput);\n}\n\nexport async function create_dkg_centralized_output_v2(\n\tcurve: number,\n\tprotocolPublicParameters: Uint8Array,\n\tsession_id: Uint8Array,\n): Promise<[Uint8Array, Uint8Array, Uint8Array]> {\n\tconst wasm = await getWasmModule();\n\treturn wasm.create_dkg_centralized_output_v2(curve, protocolPublicParameters, session_id);\n}\n\nexport async function create_sign_centralized_party_message(\n\tprotocolPublicParameters: Uint8Array,\n\tpublicOutput: Uint8Array,\n\tuserSecretKeyShare: Uint8Array,\n\tpresign: Uint8Array,\n\tmessage: Uint8Array,\n\thash: number,\n\tsignatureScheme: number,\n\tcurve: number,\n): Promise<Uint8Array> {\n\tconst wasm = await getWasmModule();\n\treturn wasm.create_sign_centralized_party_message(\n\t\tprotocolPublicParameters,\n\t\tpublicOutput,\n\t\tuserSecretKeyShare,\n\t\tpresign,\n\t\tmessage,\n\t\tcurve,\n\t\tsignatureScheme,\n\t\thash,\n\t);\n}\n\nexport async function create_sign_centralized_party_message_with_centralized_party_dkg_output(\n\tprotocolPublicParameters: Uint8Array,\n\tcentralizedDkgOutput: Uint8Array,\n\tuserSecretKeyShare: Uint8Array,\n\tpresign: Uint8Array,\n\tmessage: Uint8Array,\n\thash: number,\n\tsignatureScheme: number,\n\tcurve: number,\n): Promise<Uint8Array> {\n\tconst wasm = await getWasmModule();\n\treturn wasm.create_sign_centralized_party_message_with_centralized_party_dkg_output(\n\t\tprotocolPublicParameters,\n\t\tcentralizedDkgOutput,\n\t\tuserSecretKeyShare,\n\t\tpresign,\n\t\tmessage,\n\t\thash,\n\t\tsignatureScheme,\n\t\tcurve,\n\t);\n}\n\nexport async function network_dkg_public_output_to_protocol_pp(\n\tcurve: number,\n\tnetworkDkgPublicOutput: Uint8Array,\n): Promise<Uint8Array> {\n\tconst wasm = await getWasmModule();\n\treturn wasm.network_dkg_public_output_to_protocol_pp(curve, networkDkgPublicOutput);\n}\n\nexport async function verify_secp_signature(\n\tpublicKey: Uint8Array,\n\tsignature: Uint8Array,\n\tmessage: Uint8Array,\n\tnetworkDkgPublicOutput: Uint8Array,\n\thash: number,\n\tsignatureAlgorithm: number,\n\tcurve: number,\n): Promise<boolean> {\n\tconst wasm = await getWasmModule();\n\treturn wasm.verify_secp_signature(\n\t\tpublicKey,\n\t\tsignature,\n\t\tmessage,\n\t\tnetworkDkgPublicOutput,\n\t\tcurve,\n\t\tsignatureAlgorithm,\n\t\thash,\n\t);\n}\n\nexport async function public_key_from_dwallet_output(\n\tcurve: number,\n\tdWalletOutput: Uint8Array,\n): Promise<Uint8Array> {\n\tconst wasm = await getWasmModule();\n\treturn wasm.public_key_from_dwallet_output(curve, dWalletOutput);\n}\n\nexport async function public_key_from_centralized_dkg_output(\n\tcurve: number,\n\tcentralizedDkgOutput: Uint8Array,\n): Promise<Uint8Array> {\n\tconst wasm = await getWasmModule();\n\treturn wasm.public_key_from_centralized_dkg_output(curve, centralizedDkgOutput);\n}\n\nexport async function reconfiguration_public_output_to_protocol_pp(\n\tcurve: number,\n\treconfig_public_output: Uint8Array,\n\tnetwork_dkg_public_output: Uint8Array,\n): Promise<Uint8Array> {\n\tconst wasm = await getWasmModule();\n\treturn wasm.reconfiguration_public_output_to_protocol_pp(\n\t\tcurve,\n\t\treconfig_public_output,\n\t\tnetwork_dkg_public_output,\n\t);\n}\n\nexport async function centralized_and_decentralized_parties_dkg_output_match(\n\tcurve: number,\n\tuserPublicOutput: Uint8Array,\n\tnetworkDKGOutput: Uint8Array,\n): Promise<boolean> {\n\tconst wasm = await getWasmModule();\n\treturn wasm.centralized_and_decentralized_parties_dkg_output_match(\n\t\tcurve,\n\t\tuserPublicOutput,\n\t\tnetworkDKGOutput,\n\t);\n}\n\nexport async function create_imported_dwallet_centralized_step(\n\tcurve: number,\n\tprotocolPublicParameters: Uint8Array,\n\tsessionIdentifier: Uint8Array,\n\tsecretKey: Uint8Array,\n): Promise<[Uint8Array, Uint8Array, Uint8Array]> {\n\tconst wasm = await getWasmModule();\n\treturn wasm.create_imported_dwallet_centralized_step(\n\t\tcurve,\n\t\tprotocolPublicParameters,\n\t\tsessionIdentifier,\n\t\tsecretKey,\n\t);\n}\n\nexport async function decrypt_user_share(\n\tcurve: number,\n\tdecryptionKey: Uint8Array,\n\tdWalletPublicOutput: Uint8Array,\n\tencryptedShare: Uint8Array,\n\tprotocolPublicParameters: Uint8Array,\n): Promise<Uint8Array> {\n\tconst wasm = await getWasmModule();\n\treturn wasm.decrypt_user_share(\n\t\tcurve,\n\t\tdecryptionKey,\n\t\tdWalletPublicOutput,\n\t\tencryptedShare,\n\t\tprotocolPublicParameters,\n\t);\n}\n\nexport async function parse_signature_from_sign_output(\n\tcurve: number,\n\tsignatureAlgorithm: number,\n\tsignatureOutput: Uint8Array,\n): Promise<Uint8Array> {\n\tconst wasm = await getWasmModule();\n\treturn wasm.parse_signature_from_sign_output(curve, signatureAlgorithm, signatureOutput);\n}\n\n/**\n * Manually initialize the WASM module.\n * This is optional as functions will auto-initialize on first use.\n * Useful for preloading the WASM module during app initialization.\n */\nexport async function initializeWasm(): Promise<void> {\n\tawait ensureWasmInitialized();\n}\n"],
  "mappings": "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",
  "names": []
}
